<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="layout :: head"></head>
<body>
<header th:replace="layout :: header">
</header>

<div class="container" th:fragment="content">
    <div th:if="${username == null}">
        <div>What are you doing here?</div>
    </div>
    <div th:unless="${username == null}">
        <div th:text="'Hi ' + ${username} + ', Welcome to your account.'">Hi, username</div>
    </div>
    <div th:if="${pendingPurchase != null}">Before you can proceed, you'll need to send payment to the below address. You'll be able to submit a CSR after it has confirmed.</div><br/>
    <div th:if="${pendingPurchase != null}" th:text="${pendingPurchase}"></div>
    <img th:src="@{/qrcode}"/><br/>
    <div th:if="${confirmedPurchasesSize > 0}">
        <div>Payment History</div>
<!--        <div class="row">
            <div class="col-sm-2">ID</div>
            <div class="col-sm-2">Date Initiated</div>
            <div class="col-sm-2">Receiving Address</div>
            <div class="col-sm-2">Amount</div>
            <div class="col-sm-2">Time of 1st Confirmation</div>
            <div class="col-sm-2">Certificates</div>
        </div>
        <div class="row" th:each="purchase : ${purchases}">
            <div class="col-sm-2" th:text="${purchase.id}"></div>
            <div class="col-sm-2" th:text="${purchase.dateInitiated}"></div>
            <div class="col-sm-2" th:text="${purchase.receivingAddress}"></div>
            <div th:if="${purchase.dateConfirm1 == null}" class="col-sm-6 alert alert-warning">Unconfirmed payment!</div>
            <div th:unless="${purchase.dateConfirm1 == null}" class="col-sm-2" th:text="${purchase.amount}"></div>
            <div th:unless="${purchase.dateConfirm1 == null}" class="col-sm-2" th:text="${purchase.dateConfirm1}"></div>
            <div th:unless="${purchase.dateConfirm1 == null}" class="col-sm-2"><a th:href="'/csr?purchaseId=' + ${purchase.id}">cert</a></div>
        </div>-->
        <table th:classappend="table">
            <tr>
                <!--<th>ID</th>-->
                <th>Date Initiated</th>
                <th>Receiving address</th>
                <th>Amount</th>
                <th>Time of 1st Confirmation</th>
                <th>Certs</th>
            </tr>
            <tr th:each="purchase : ${confirmedPurchases}">
                <!--<td th:text="${purchase.id}"></td>-->
                <td th:text="${purchase.dateInitiated}"></td>
                <td th:text="${purchase.receivingAddress}"></td>
                <td th:if="${purchase.dateConfirm1 != null}" th:text="${purchase.amount}">amount</td>
                <td th:if="${purchase.dateConfirm1 != null}" th:text="${purchase.dateConfirm1}">1st confirmation</td>
                <td th:if="${purchase.dateConfirm1 != null}"><a th:href="'/certs?purchaseId=' + ${purchase.id}">certs</a></td>
                <td class="alert alert-warning" th:unless="${purchase.dateConfirm1 != null}" th:colspan="3"><a th:href="@{/enterpayment}">Awaiting Confirmation</a></td>
            </tr>
        </table>
    </div>
  <!--  <div th:unless="${purchasesSize > 0}"><h1>Looks like you've never made a purchase. Better get on that &ndash;&gt; <a href="#" th:href="@{/enterpayment}">Initiate payment</a></h1></div>

-->
</div>

</body>
</html>