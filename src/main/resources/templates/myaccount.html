<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="layout :: head"></head>
<body>
<header th:replace="layout :: header">
</header>

<div class="container" th:fragment="content">
    <div th:if="${certAdded}" class="alert alert-success">You've <strong>added</strong> a certificate.</div>
    <div th:if="${certDeleted}" class="alert alert-success">You've <strong>deleted</strong> a certificate.</div>
    <h3 th:if="${username == null}">What are you doing here?</h3>
    <h3 th:unless="${username == null}" th:text="'Hi ' + ${username} + ', Welcome to your account.'">Hi, username</h3>
    <div th:if="${pendingPurchase != null}">Before you can proceed, you'll need to send payment to the below address. You'll be able to submit a CSR after it has confirmed.</div><br/>
    <div th:if="${pendingPurchase != null}" th:text="'bitcoin:'+${pendingPurchase}"></div>
    <img th:src="@{/qrcode}"/><br/>
    <div th:if="${confirmedPurchasesSize > 0}">
        <h3>Payment History</h3>
        <table th:classappend="table">
            <tr>
                <!--<th>ID</th>-->
                <!--<th>Date Initiated</th> -->
                <th>Receiving address</th>
                <th>Amount</th>
                <th>Time of 1st Confirmation</th>
<!--
                <th>Certs</th>
-->
            </tr>
            <tr th:each="purchase : ${confirmedPurchases}">
                <!--<td th:text="${purchase.id}"></td>-->
                <!-- <td th:text="${purchase.dateInitiated}"></td> -->
                <td th:text="${purchase.receivingAddress}"></td>
                <td th:if="${purchase.dateConfirm1 != null}" th:text="${purchase.amount}">amount</td>
                <td th:if="${purchase.dateConfirm1 != null}" th:text="${purchase.dateConfirm1}">1st confirmation</td>
<!--
                <td th:if="${purchase.dateConfirm1 != null}"><a th:href="'/certs?purchaseId=' + ${purchase.id}">certs</a></td>
-->
                <td class="alert alert-warning" th:unless="${purchase.dateConfirm1 != null}" th:colspan="3"><a th:href="@{/enterpayment}">Awaiting Confirmation</a></td>
            </tr>
        </table>

        <h3>Certificates</h3>
        <div th:if="${certificatesSize == 0}">You don't have any certificates yet.</div>
        <a href="/certs">add a certificate</a>
        <table th:unless="${certificatesSize == 0}" th:classappend="table">
            <tr>
                <!--<th>ID</th>-->
    <!--
                <th>Date Initiated</th>
    -->
    <!--
                <th>CSR</th>
    -->
                <th>Certificate</th>
                <th>Delete?</th>
            </tr>
            <tr th:each="certificate : ${certificates}">
    <!--
                <td th:text="${certificate.id}"></td>
    -->
    <!--
                <td th:text="${certificate.dateInitiated}"></td>
    -->
    <!--
                <td><pre th:text="${certificate.csrText}"></pre></td>
    -->
                <td><pre th:text="${certificate.certText}">certificate text</pre></td>
                <td><a th:href="'/deleteCert?serial='+${certificate.serial}">delete</a></td>
            </tr>
        </table>
    </div>
  <!--  <div th:unless="${purchasesSize > 0}"><h1>Looks like you've never made a purchase. Better get on that &ndash;&gt; <a href="#" th:href="@{/enterpayment}">Initiate payment</a></h1></div>

-->
</div>

</body>
</html>