<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="layout :: head"></head>
<body>
<header th:replace="layout :: header">
</header>

<div class="container" th:fragment="content">
    <div th:if="${username == null}">
        <div>What are you doing here?</div>
    </div>
    <div th:unless="${username == null}">
        <div th:text=" 'Hi,' + ${username} + 'here are the certs for your purchase.'">Hi, username</div>

    </div>

    <div th:if="${certificatesSize == 0}">You haven't submitted a CSR yet.</div>
    <table th:unless="${certificatesSize == 0}" th:classappend="table">
        <tr>
            <!--<th>ID</th>-->
            <th>Date Initiated</th>
            <th>CSR</th>
            <th>Certificate</th>
            <th>Revoke?</th>
        </tr>
        <tr th:each="certificate : ${certificates}">
<!--
            <td th:text="${certificate.id}"></td>
-->
            <td th:text="${certificate.dateInitiated}"></td>
            <td><pre th:text="${certificate.csrText}"></pre></td>
            <td><pre th:text="${certificate.certText}">certificate text</pre></td>
            <td th:if="${certificate.revoked}">REVOKED!</td>
            <td th:unless="${certificate.revoked}"><a th:href="'/revoke?serial='+${certificate.serial}">revoke</a></td>
        </tr>
    </table>

    <form name="f" th:action="@{/certs}" method="post">
        <div>Paste in a PEM-formatted CSR.</div>
        <fieldset>
            <label for="csr">CSR:</label>
            <textarea id="csr" name="csr" cols="70" rows="6"/>
            <p th:if="${csr_error} != null" th:text="${csr_error}"></p><br/>

            <input type="hidden" name="purchaseId" th:value="${purchaseId}"></input>
        </fieldset>
        <div class="form-actions">
            <button type="submit" class="btn">Request Cert</button>
        </div>
    </form>
</div>

</body>
</html>