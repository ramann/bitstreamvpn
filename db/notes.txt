alter table certificate add column serial bigint;

create table certificate (
id serial primary key not null,
username varchar(30) not null references users,
date_initiated timestamp not null,
csr_text varchar(4096) not null,
signed boolean not null,
cert_text varchar(4096),
revoked boolean,
serial bigint,

);

create table certificate
(
	id serial not null
		constraint certificate_pkey
			primary key,
	username varchar(30) not null
		constraint certificate_username_fkey
			references users,
	date_initiated timestamp not null,
	csr_text varchar(4096) not null,
	signed boolean not null,
	cert_text varchar(4096),
	revoked boolean,
	serial bigint
)
;



create table product
(
	title varchar(40) not null
		constraint product_pkey
			primary key,
	descr varchar(128) not null,
	price numeric(5,2) not null,
	username varchar(30) not null
)
;



create table subscription (
title varchar(20) not null primary key,
duration integer not null,
price numeric(11,8) not null,
username varchar(30) references users
);


create table payment (
	id serial not null constraint payment_pkey primary key,
	username varchar(30) not null constraint payment_username_fkey references users,
	date_initiated timestamp not null,
	amount numeric(11,8) not null,
	receiving_address varchar(40) not null,
	date_confirm_1 timestamp,
	date_confirm_3 timestamp,
	date_confirm_6 timestamp
);



create table users
(
	username varchar(30) not null
		constraint users_pkey
			primary key,
	password varchar(64) not null,
	salt varchar(16) not null
)
;

